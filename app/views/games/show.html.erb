<section class="bg-white p-4">
  <h1 class="text-3xl font-bold text-cyan-900 mb-4"><%= @game.title %></h1>

  <div>
    <div class="flex-col border-emerald-500 gap-4 md:flex md:flex-row">
      <div class="h-80 w-[16rem] md:w-[23rem]"><%= image_tag @game.cover_image, class:"game-show-img ", alt:"cover image for #{@game.title}"%></div>
      <div class="genre mt-2">
        <ul class="flex gap-2">
          <% if @game.genres.present? %>
              <% @game.genres.each do |genre| %>
          <li
            class="rounded-3xl capitalize border-2 text-sm border-gray-200 p-2"
          >
            <%= genre.name %>
          </li> 
             <% end %>
          <% end %>
        </ul>
        <ul class="flex gap-2 directors mt-3">
        <%= render "director", game:@game %> 
      
        </ul>
        <ul class="flex gap-2 directors mt-3">
            <%= render "writer", game:@game %>
        </ul>
        <p class="mt-3"> <span class="font-bold text-cyan-700">release date: </span><%= format_date(@game.release_date) %></p>
        <div class="full-description mt-8 text-xl mb-6 font-medium text-gray-800 ">
         <%= @game.description %>
        </div>
        <% if is_admin? %>
        <div class="flex justify-end px-8 gap-2">

          <%= link_to 'Edit Game', edit_game_path(@game), class:'bg-gray-400 text-white p-2 mt-6 rounded-sm hover:bg-gray-600' %>
          <%= link_to 'Delete Game', @user, data:{turbo_method:'delete', turbo_confirm:'Are you sure'}, class:'bg-red-400 text-white p-2 mt-6 rounded-sm hover:bg-red-600' %>
        </div>
        <% end %>
      </div>
    </div>
  </div>
  <% if current_user.present? %>
  
  <div class="actions flex gap-3 text-white my-3">
    <% if @favorite.present? %>
    <%= button_to "♥️ Remove from favorite", game_favorite_path(@game, @favorite), class:" rounded-md bg-black
    hover:bg-cyan-700 transition-all px-4 py-2", method:'delete' %>

    <% else %>
    <%= button_to "♥️ Add to favorites", game_favorites_path(@game), class:" rounded-md bg-black
    hover:bg-cyan-700 transition-all px-4 py-2" %>
    <% end %>
   
    <!-- prettier-ignore -->

     <% if !@review  %>
    <%= link_to "Add review", new_game_review_path(@game), class:" rounded-md bg-black
    hover:bg-cyan-700 transition-all px-4 py-2" %>
    <% end %>

  </div>
 <% end %>
 <p class="font-bold text-sm text-cyan-950 mt-2"> <%= pluralize(@likers.size, 'like') %></p>

 <div class="mt-10 border-t-2 border-dashed border-gray-100 py-6">
  <h3 class="text-cyan-950 font-bold text-3xl">All Reviews</h3>

  <ul>
    <% @game.reviews.order(created_at).each do |review| %>
      <li class="mb-3 border-b-2 border-dashed border-gray-50 py-3">
      <div class="flex justify-between items-end p-3">
        <div class="flex">

          <h5 class="font-bold text-2xl text-cyan-900 flex gap-3 items-baseline"><%= link_to review.user.name, review.user %>  <%= content_tag :span, number_with_precision(review.rate, precision:1), class:"rounded-full py-2 px-4 text-white #{rate_bg(review.rate)}" %>
          </h5>
        </div>

        <div>
          <span class="italic text-sm text-gray-400"><%= time_ago_in_words(review.created_at) %> ago</span>
        </div>
      </div>
      <p class="py-2 px-3"><%= review.review_text %></p>
      <div class="actions flex justify-end gap-3">
        <% if current_user && review.user == current_user %>
          <%= link_to "Edit Review",edit_game_review_path(@game, review), class:"border-b border-gray-200 pb-1 hover:border-b-gray-400 transition-all" %>
          <%= link_to "Delete Review", game_review_path(@game, review), data:{turbo_method:"delete", turbo_confirm: "Delete your review for #{@game.title} ?"}, class:"border-b border-red-200 pb-1 hover:border-b-red-400 transition-all" %>
        <% end %>
      </div>
      </li>
    <% end %>
  </ul>
 </div>
</section>
